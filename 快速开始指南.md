# 🚀 OpenAPI 转 MCP Server - 快速开始指南

## 📋 项目简介

这是一个将 OpenAPI 规范快速转换为 MCP Server 配置文件的 Web 应用。通过美观的界面，你可以轻松上传 OpenAPI 文件，并获得转换后的 MCP 配置。

## 🎯 三种使用方式

### 方式一：Docker 部署（推荐，免安装）

#### 1️⃣ 使用 Docker Compose（最简单）

```bash
# 启动服务
docker-compose up -d

# 查看日志
docker-compose logs -f

# 停止服务
docker-compose down
```

访问：http://localhost:3000

#### 2️⃣ 使用 Docker 命令

```bash
# 构建镜像
docker build -t openapi-to-mcp-server .

# 运行容器
docker run -d \
  -p 3000:3000 \
  --name openapi-mcp \
  openapi-to-mcp-server

# 查看日志
docker logs -f openapi-mcp

# 停止容器
docker stop openapi-mcp
docker rm openapi-mcp
```

### 方式二：本地开发运行

#### 前置条件

- Node.js 18 或更高版本
- Go 1.23 或更高版本

#### 步骤

```bash
# 1. 安装 openapi-to-mcp 工具
bash scripts/install-go-tool.sh
# 或手动安装：
go install github.com/higress-group/openapi-to-mcpserver/cmd/openapi-to-mcp@latest

# 2. 安装 Node.js 依赖
npm install

# 3. 启动服务
npm start
# 或使用启动脚本：
bash scripts/start.sh

# 开发模式（支持热重载）
npm run dev
```

访问：http://localhost:3000

### 方式三：Windows 系统

#### 使用 Docker Desktop（推荐）

1. 安装 [Docker Desktop for Windows](https://www.docker.com/products/docker-desktop)
2. 在项目目录打开 PowerShell 或 CMD
3. 运行：
```cmd
docker-compose up -d
```

#### 本地运行

1. 安装 [Node.js](https://nodejs.org/)
2. 安装 [Go 1.23+](https://golang.org/dl/)
3. 在 PowerShell 中运行：

```powershell
# 安装 Go 工具
go install github.com/higress-group/openapi-to-mcpserver/cmd/openapi-to-mcp@latest

# 安装依赖
npm install

# 启动服务
npm start
```

## 🎨 使用界面

### 1. 上传文件

- **拖拽上传**：将 OpenAPI 文件拖到上传区域
- **点击上传**：点击上传区域选择文件
- 支持格式：`.json`、`.yaml`、`.yml`
- 文件大小：最大 10MB

### 2. 配置参数

| 参数 | 说明 | 示例 |
|------|------|------|
| 服务器名称 | MCP 服务器的标识 | `petstore`, `payment-api` |
| 工具前缀 | 为工具添加前缀 | `api_`, `tool_` |
| 输出格式 | YAML 或 JSON | `yaml` |
| 验证规范 | 是否严格验证 | ☑️ |

### 3. 转换和下载

- 点击 **"开始转换"** 按钮
- 查看生成的配置预览
- 选择：
  - 📥 **下载配置文件**
  - 📋 **复制到剪贴板**

## 📝 使用示例

项目包含一个示例文件：`examples/petstore.json`

你可以用它来测试转换功能：

1. 访问 http://localhost:3000
2. 上传 `examples/petstore.json`
3. 服务器名称填写：`petstore`
4. 点击"开始转换"
5. 查看生成的 MCP 配置

## 🔧 API 接口说明

### 转换接口

```bash
curl -X POST http://localhost:3000/api/convert \
  -F "file=@petstore.json" \
  -F "serverName=petstore" \
  -F "format=yaml"
```

### 健康检查

```bash
curl http://localhost:3000/api/health
```

响应示例：
```json
{
  "success": true,
  "status": "healthy",
  "message": "OpenAPI to MCP 服务运行正常"
}
```

## 🐛 常见问题

### Q1: 转换失败，提示 "Go 命令不可用"

**A:** 确保已安装 `openapi-to-mcp` 工具：

```bash
# macOS/Linux
go install github.com/higress-group/openapi-to-mcpserver/cmd/openapi-to-mcp@latest

# 验证安装
openapi-to-mcp --help
```

如果使用 Docker，不需要本地安装 Go 工具。

### Q2: Docker 容器无法启动

**A:** 检查步骤：

1. 确认 Docker 正在运行
2. 检查端口 3000 是否被占用
3. 查看容器日志：`docker-compose logs`

### Q3: 文件上传失败

**A:** 可能原因：

- 文件大小超过 10MB
- 文件格式不是 JSON/YAML
- 文件内容不符合 OpenAPI 规范

### Q4: 转换后的配置如何使用？

**A:** 生成的配置文件可以：

1. 用于配置 Higress MCP Server
2. 集成到你的 AI 应用中
3. 作为 API 网关配置

参考：[Higress MCP 配置文档](https://higress.cn/en/ai/mcp-quick-start/)

## 📚 相关资源

- **OpenAPI 规范**: https://swagger.io/specification/
- **MCP 协议**: https://modelcontextprotocol.io/
- **Higress 项目**: https://higress.io/
- **转换工具源码**: https://github.com/higress-group/openapi-to-mcpserver

## 💡 小贴士

1. **使用 Docker 最省心**：无需配置 Go 环境，一键启动
2. **命名规范**：服务器名称建议使用小写字母和连字符
3. **验证开关**：如果文件格式确定无误，可以关闭验证以提高速度
4. **输出格式**：YAML 更易读，JSON 更适合程序处理

## 🆘 获取帮助

如果遇到问题：

1. 查看 [README.md](README.md) 了解详细信息
2. 检查 Docker 日志：`docker-compose logs -f`
3. 访问健康检查接口：http://localhost:3000/api/health
4. 提交 Issue 到项目仓库

---

**祝你使用愉快！** 🎉

